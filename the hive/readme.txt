
####################################################################################
#  Скрипт выгрузки инцидентов MP SIEM и связанных с инцидентом событий в The Hive  #
####################################################################################

Состав:
    1) mpsiem2hive.py 			- скрипт выгрузки
    2) config.json   			- настройки скрипта
    3) settings_crontab.txt		- настройки crontab


######################################################
          mpsiem2hive.py - Изменяемые параметры
######################################################
Параметры расположены на 19 и 20 строке файла.

Пример :
    CONFIG = "config.json"   # Название файла настроек скрипта
    INC_PERIOD = 480         # Период мониторинга инцидентов (в секундах) 


######################################################
           config.json - Изменяемые параметры
######################################################

Пример :
  
    Логин учётной записи MP SIEM
    "export_core_user": "Administrator",

    Пароль учётной записи MP SIEM (Значение корректируется при запуске скрипта с параметром -e:   python mpsiem2hive.py -e. И вводе правильного пароля учётной записи)
    "export_core_pass": "gAAAAABeAxK5uqwPhUfty6GJQ-kCw-j_u6m5tiCLPDoxTDAWQfwXnx-GMlsQtW3KZkDbPn5fuLzD0QPH2vE84mWMQTdLdDcN1A==",
  
    URL веб-интерфейса MP SIEM (в конце НЕ НУЖЕН знак слэша [/] )
    "export_core_url": "https://192.168.222.222",
 
    API-ключ, формируемый в веб-интерфейсе The Hive
    "hive_api_key": "mIzqjrOLOLOLOLOEPfDqBs0Lji",
  
    URL веб-интерфейса The Hive
    "hive_url": "http://192.168.111.111:9000",
  
    Название файла где хранится номер последнего переданного в The Hive инцидента
    "logfile": "last_processed_incident.log",
  
    Текущий период мониторинга инцидентов. Скрипт корректирует значение автоматически. 
    "time_from": 480


######################################################
       settings_crontab.txt - Изменяемые параметры
######################################################

Пример:
      */5 * * * * /usr/bin/python3.5 /home/script/mpsiem2hive.py >> /home/script/cron.log 2>&1

        ^                 ^                       ^                          ^
        |                 |                       |                          |
     период              чем                     что                     путь файла
     запуска          запускаем               запускаем             логов запуска скрипта
 (каждые 5 минут)

Рекомендуем установить "Период запуска" равным половине значения периода мониторинга.
Пример:
    Если период мониторинга равен 600 секундам (INC_PERIOD = 600), то период запуска скрипта составит 5 минут


